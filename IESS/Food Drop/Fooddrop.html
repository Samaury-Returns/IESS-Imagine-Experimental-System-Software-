<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Emoji Food Drop</title>
<style>
body {
  margin: 0;
  background: #87ceeb;
  font-family: Arial;
  text-align: center;
  user-select: none;
  touch-action: none;
}
#game {
  width: 400px;
  height: 500px;
  background: #c2f0c2;
  margin: auto;
  position: relative;
  overflow: hidden;
  border: 3px solid #333;
}
#player {
  font-size: 40px;
  position: absolute;
  bottom: 10px;
  left: 180px;
}
.item {
  font-size: 30px;
  position: absolute;
  top: -40px;
}
#score {
  font-size: 20px;
  margin: 6px;
}
#missed {
  font-size: 16px;
}
#controls {
  display: flex;
  justify-content: space-between;
  margin: 10px auto;
  width: 400px;
}
.btn {
  width: 180px;
  padding: 25px;
  background: #222;
  color: white;
  font-size: 32px;
  border-radius: 20px;
}

/* Jumpscare */
#jumpscare {
  position: fixed;
  inset: 0;
  background: black;
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 999;
}
#jumpscare img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Game Over */
#gameover {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  color: white;
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  z-index: 1000;
}

body, #score, #missed, #gameover h1, #reason, .btn {
  font-family: 'Tagesschrift', cursive;
}
</style>
<link href="https://fonts.googleapis.com/css2?family=Tagesschrift&display=swap" rel="stylesheet">
</head>
<body>

<h2>üçé Emoji Food Drop</h2>
<div id="score">Score: 0</div>
<div id="missed">Missed: 0 / 12</div>

<div id="game">
  <div id="player">üòã</div>
</div>

<div id="controls">
  <div class="btn" id="leftBtn">‚¨ÖÔ∏è</div>
  <div class="btn" id="rightBtn">‚û°Ô∏è</div>
</div>

<!-- Jumpscare -->
<div id="jumpscare">
  <img src="67!.png">
</div>

<!-- Game Over -->
<div id="gameover">
  <h1>üíÄ GAME OVER üíÄ</h1>
  <p id="reason"></p>
  <button onclick="location.reload()">Restart</button>
</div>

<div id="credits">
üéµ ‚ÄúCruising for Goblins‚Äù Kevin MacLeod (incompetech.com)<br>
Licensed under CC BY 4.0
</div>

<audio id="eatSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_4bfb0c84b5.mp3"></audio>
<audio id="badSound" src="https://cdn.pixabay.com/audio/2022/03/10/audio_6d5c5db3c6.mp3"></audio>
<audio id="bgMusic" src="Cruising for Goblins.mp3" loop></audio>

<script>
const game = document.getElementById("game");
const player = document.getElementById("player");
const scoreText = document.getElementById("score");
const missedText = document.getElementById("missed");
const jumpscare = document.getElementById("jumpscare");
const gameover = document.getElementById("gameover");
const reasonText = document.getElementById("reason");
let bossSpawned = false;
const bgMusic = document.getElementById("bgMusic");
const eatSound = document.getElementById("eatSound");
const badSound = document.getElementById("badSound");
const scareSound = new Audio("67_SQlv2Xv.mp3");
const gameOverSound = new Audio("Sound_tooltip_failure.ogg");

let score = 0;
let missed = 0;
let x = 180;
let speed = 0;
let left = false;
let right = false;
let alive = true;
let musicStarted = false;

let spawnDelay = 800;

// üéµ music start
document.addEventListener("pointerdown", () => {
  if (!musicStarted) {
    bgMusic.volume = 0.5;
    bgMusic.play();
    musicStarted = true;
  }
}, { once: true });

// üéÆ controls
leftBtn.onpointerdown = () => left = true;
leftBtn.onpointerup = leftBtn.onpointerleave = () => left = false;
rightBtn.onpointerdown = () => right = true;
rightBtn.onpointerup = rightBtn.onpointerleave = () => right = false;

document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") left = true;
  if (e.key === "ArrowRight") right = true;
});
document.addEventListener("keyup", e => {
  if (e.key === "ArrowLeft") left = false;
  if (e.key === "ArrowRight") right = false;
});

// üßà movement
function update() {
  if (!alive) return;
  if (left) speed = -5;
  else if (right) speed = 5;
  else speed *= 0.85;

  x += speed;
  x = Math.max(0, Math.min(360, x));
  player.style.left = x + "px";
  requestAnimationFrame(update);
}
update();

// SESEINTA Y SIETE!!!!!!!!!!!
function triggerJumpscare() {
  jumpscare.style.display = "flex";
  scareSound.currentTime = 0;
  scareSound.play();
  setTimeout(() => jumpscare.style.display = "none", 700);
}

// üíÄ game over
function endGame(text) {
  if (!alive) return;

  alive = false;

  // stop background music
  bgMusic.pause();
  bgMusic.currentTime = 0;

  // play game over sound
  gameOverSound.currentTime = 0;
  gameOverSound.play();

  reasonText.textContent = text;
  gameover.style.display = "flex";
}

// üìà difficulty ramp
function difficulty() {
  spawnDelay = Math.max(350, 800 - score * 25);
}

// üçé items
function spawnItem() {
  if (!alive) return;

  const item = document.createElement("div");
  item.className = "item";

  const bombChance = Math.min(0.4, 0.3 + score * 0.01);
  const food = Math.random() > bombChance;

  item.textContent = food ? "üçé" : "üí£";
  item.style.left = Math.random() * 360 + "px";
  game.appendChild(item);

  let y = -40;
  let fallSpeed = 3 + score * 0.15;

  const fall = setInterval(() => {
    if (!alive) { clearInterval(fall); return; }

    y += fallSpeed;
    item.style.top = y + "px";

    // ‚úÖ FIXED collision
    const i = item.getBoundingClientRect();
    const p = player.getBoundingClientRect();
    const g = game.getBoundingClientRect();

    const ix = i.left - g.left + 5;
    const iy = i.top - g.top + 5;
    const iw = i.width - 10;
    const ih = i.height - 10;

    const px = p.left - g.left;
    const py = p.top - g.top;
    const pw = p.width;
    const ph = p.height;

    if (
      ix < px + pw &&
      ix + iw > px &&
      iy < py + ph &&
      iy + ih > py
    ) {
      if (food) {
        score++;
        eatSound.play();
        if (score === 6 || score === 7 || score === 67) triggerJumpscare();
        if (score === 15 || score === 25 || score === 35 || score === 45 || score === 55 || score === 65 || score === 75 || score === 85 || score === 100) spawnBossBomby();
      } else {
        badSound.play();
        endGame("You touched Bomby üí£");
      }
      scoreText.textContent = "Score: " + score;
      difficulty();
      item.remove();
      clearInterval(fall);
    }

    if (y > 500 && food) {
      missed++;
      missedText.textContent = "Missed: " + missed + " / 12";
      if (missed >= 12) endGame("Too much food wasted üçé");
      item.remove();
      clearInterval(fall);
    }

    if (y > 500 && !food) {
      item.remove();
      clearInterval(fall);
    }
  }, 20);
}

function spawnBossBomby() {
  if (!alive || bossSpawned) return;
  bossSpawned = true;

  const boss = document.createElement("div");
  boss.className = "item";
  boss.textContent = "üí£";
  boss.style.fontSize = "60px";
  boss.style.left = "150px";
  game.appendChild(boss);

  let y = -80;
  let xPos = 150;
  let dir = 1;

  const fall = setInterval(() => {
    if (!alive) { clearInterval(fall); return; }

    y += 2;                 // slow fall
    xPos += dir * 2;        // side movement

    if (xPos < 0 || xPos > 320) dir *= -1;

    boss.style.top = y + "px";
    boss.style.left = xPos + "px";

    // collision (same fixed logic)
    const i = boss.getBoundingClientRect();
    const p = player.getBoundingClientRect();
    const g = game.getBoundingClientRect();

    const ix = i.left - g.left + 10;
    const iy = i.top - g.top + 10;
    const iw = i.width - 20;
    const ih = i.height - 20;

    const px = p.left - g.left;
    const py = p.top - g.top;
    const pw = p.width;
    const ph = p.height;

    if (
      ix < px + pw &&
      ix + iw > px &&
      iy < py + ph &&
      iy + ih > py
    ) {
      badSound.play();
      endGame("Boss Bomby got you üí£üëë");
      boss.remove();
      clearInterval(fall);
    }

    // boss leaves safely
    if (y > 520) {
      boss.remove();
      clearInterval(fall);
    }
  }, 20);
}

// ‚è±Ô∏è adaptive spawn loop
function spawnLoop() {
  spawnItem();
  if (alive) setTimeout(spawnLoop, spawnDelay);
}
spawnLoop();
</script>


</body>
</html>
